[["rhc-data-description.html", "Chapter 1 RHC data description 1.1 Data download 1.2 Analytic data 1.3 Notations 1.4 Variables 1.5 Table 1 stratified by RHC exposure 1.6 Basic regression analysis 1.7 Comparison with literature", " Chapter 1 RHC data description There is a widespread belief among cardiologists that the right heart catheterization (RHC hereafter; a monitoring device for measurement of cardiac function) is helpful in managing critically ill patients in the intensive care unit. Connors et al. (1996) examined the association of RHC use during the first 24 hours of care in the intensive care unit and a number of health-outcomes such as length of stay (hospital). 1.1 Data download Data is freely available from Vanderbilt Biostatistics. # load the dataset ObsData &lt;- read.csv(&quot;https://hbiostat.org/data/repo/rhc.csv&quot;, header = TRUE) saveRDS(ObsData, file = &quot;data/rhc.RDS&quot;) 1.2 Analytic data # add column for outcome Y: length of stay # Y = date of discharge - study admission date # Y = date of death - study admission date if date of discharge not available ObsData$Y &lt;- ObsData$dschdte - ObsData$sadmdte ObsData$Y[is.na(ObsData$Y)] &lt;- ObsData$dthdte[is.na(ObsData$Y)] - ObsData$sadmdte[is.na(ObsData$Y)] # remove outcomes we are not examining in this example ObsData &lt;- dplyr::select(ObsData, !c(dthdte, lstctdte, dschdte, death, t3d30, dth30, surv2md1)) # remove unnecessary and problematic variables ObsData &lt;- dplyr::select(ObsData, !c(sadmdte, ptid, X, adld3p, urin1, cat2)) # convert all categorical variables to factors factors &lt;- c(&quot;cat1&quot;, &quot;ca&quot;, &quot;cardiohx&quot;, &quot;chfhx&quot;, &quot;dementhx&quot;, &quot;psychhx&quot;, &quot;chrpulhx&quot;, &quot;renalhx&quot;, &quot;liverhx&quot;, &quot;gibledhx&quot;, &quot;malighx&quot;, &quot;immunhx&quot;, &quot;transhx&quot;, &quot;amihx&quot;, &quot;sex&quot;, &quot;dnr1&quot;, &quot;ninsclas&quot;, &quot;resp&quot;, &quot;card&quot;, &quot;neuro&quot;, &quot;gastr&quot;, &quot;renal&quot;, &quot;meta&quot;, &quot;hema&quot;, &quot;seps&quot;, &quot;trauma&quot;, &quot;ortho&quot;, &quot;race&quot;, &quot;income&quot;) ObsData[factors] &lt;- lapply(ObsData[factors], as.factor) # convert our treatment A (RHC vs. No RHC) to a binary variable ObsData$A &lt;- ifelse(ObsData$swang1 == &quot;RHC&quot;, 1, 0) ObsData &lt;- dplyr::select(ObsData, !swang1) # Categorize the variables to match with the original paper ObsData$age &lt;- cut(ObsData$age,breaks=c(-Inf, 50, 60, 70, 80, Inf),right=FALSE) ObsData$race &lt;- factor(ObsData$race, levels=c(&quot;white&quot;,&quot;black&quot;,&quot;other&quot;)) ObsData$sex &lt;- as.factor(ObsData$sex) ObsData$sex &lt;- relevel(ObsData$sex, ref = &quot;Male&quot;) ObsData$cat1 &lt;- as.factor(ObsData$cat1) levels(ObsData$cat1) &lt;- c(&quot;ARF&quot;,&quot;CHF&quot;,&quot;Other&quot;,&quot;Other&quot;,&quot;Other&quot;, &quot;Other&quot;,&quot;Other&quot;,&quot;MOSF&quot;,&quot;MOSF&quot;) ObsData$ca &lt;- as.factor(ObsData$ca) levels(ObsData$ca) &lt;- c(&quot;Metastatic&quot;,&quot;None&quot;,&quot;Localized (Yes)&quot;) ObsData$ca &lt;- factor(ObsData$ca, levels=c(&quot;None&quot;, &quot;Localized (Yes)&quot;,&quot;Metastatic&quot;)) # Rename variables names(ObsData) &lt;- c(&quot;Disease.category&quot;, &quot;Cancer&quot;, &quot;Cardiovascular&quot;, &quot;Congestive.HF&quot;, &quot;Dementia&quot;, &quot;Psychiatric&quot;, &quot;Pulmonary&quot;, &quot;Renal&quot;, &quot;Hepatic&quot;, &quot;GI.Bleed&quot;, &quot;Tumor&quot;, &quot;Immunosupperssion&quot;, &quot;Transfer.hx&quot;, &quot;MI&quot;, &quot;age&quot;, &quot;sex&quot;, &quot;edu&quot;, &quot;DASIndex&quot;, &quot;APACHE.score&quot;, &quot;Glasgow.Coma.Score&quot;, &quot;blood.pressure&quot;, &quot;WBC&quot;, &quot;Heart.rate&quot;, &quot;Respiratory.rate&quot;, &quot;Temperature&quot;, &quot;PaO2vs.FIO2&quot;, &quot;Albumin&quot;, &quot;Hematocrit&quot;, &quot;Bilirubin&quot;, &quot;Creatinine&quot;, &quot;Sodium&quot;, &quot;Potassium&quot;, &quot;PaCo2&quot;, &quot;PH&quot;, &quot;Weight&quot;, &quot;DNR.status&quot;, &quot;Medical.insurance&quot;, &quot;Respiratory.Diag&quot;, &quot;Cardiovascular.Diag&quot;, &quot;Neurological.Diag&quot;, &quot;Gastrointestinal.Diag&quot;, &quot;Renal.Diag&quot;, &quot;Metabolic.Diag&quot;, &quot;Hematologic.Diag&quot;, &quot;Sepsis.Diag&quot;, &quot;Trauma.Diag&quot;, &quot;Orthopedic.Diag&quot;, &quot;race&quot;, &quot;income&quot;, &quot;Y&quot;, &quot;A&quot;) saveRDS(ObsData, file = &quot;data/rhcAnalytic.RDS&quot;) 1.3 Notations Notations Example in RHC study \\(A\\): Exposure status RHC \\(Y\\): Observed outcome length of stay \\(Y(A=1)\\) = potential outcome when exposed length of stay when RHC used \\(Y(A=0)\\) = potential outcome when not exposed length of stay when RHC not used \\(L\\): Covariates See below 1.4 Variables baselinevars &lt;- names(dplyr::select(ObsData, !c(A,Y))) baselinevars ## [1] &quot;Disease.category&quot; &quot;Cancer&quot; &quot;Cardiovascular&quot; ## [4] &quot;Congestive.HF&quot; &quot;Dementia&quot; &quot;Psychiatric&quot; ## [7] &quot;Pulmonary&quot; &quot;Renal&quot; &quot;Hepatic&quot; ## [10] &quot;GI.Bleed&quot; &quot;Tumor&quot; &quot;Immunosupperssion&quot; ## [13] &quot;Transfer.hx&quot; &quot;MI&quot; &quot;age&quot; ## [16] &quot;sex&quot; &quot;edu&quot; &quot;DASIndex&quot; ## [19] &quot;APACHE.score&quot; &quot;Glasgow.Coma.Score&quot; &quot;blood.pressure&quot; ## [22] &quot;WBC&quot; &quot;Heart.rate&quot; &quot;Respiratory.rate&quot; ## [25] &quot;Temperature&quot; &quot;PaO2vs.FIO2&quot; &quot;Albumin&quot; ## [28] &quot;Hematocrit&quot; &quot;Bilirubin&quot; &quot;Creatinine&quot; ## [31] &quot;Sodium&quot; &quot;Potassium&quot; &quot;PaCo2&quot; ## [34] &quot;PH&quot; &quot;Weight&quot; &quot;DNR.status&quot; ## [37] &quot;Medical.insurance&quot; &quot;Respiratory.Diag&quot; &quot;Cardiovascular.Diag&quot; ## [40] &quot;Neurological.Diag&quot; &quot;Gastrointestinal.Diag&quot; &quot;Renal.Diag&quot; ## [43] &quot;Metabolic.Diag&quot; &quot;Hematologic.Diag&quot; &quot;Sepsis.Diag&quot; ## [46] &quot;Trauma.Diag&quot; &quot;Orthopedic.Diag&quot; &quot;race&quot; ## [49] &quot;income&quot; 1.5 Table 1 stratified by RHC exposure Only for some demographic and co-morbidity variables; match with Table 1 in Connors et al. (1996). require(tableone) tab0 &lt;- CreateTableOne(vars = c(&quot;age&quot;, &quot;sex&quot;, &quot;race&quot;, &quot;Disease.category&quot;, &quot;Cancer&quot;), data = ObsData, strata = &quot;A&quot;, test = FALSE) print(tab0, showAllLevels = FALSE, ) ## Stratified by A ## 0 1 ## n 3551 2184 ## age (%) ## [-Inf,50) 884 (24.9) 540 (24.7) ## [50,60) 546 (15.4) 371 (17.0) ## [60,70) 812 (22.9) 577 (26.4) ## [70,80) 809 (22.8) 529 (24.2) ## [80, Inf) 500 (14.1) 167 ( 7.6) ## sex = Female (%) 1637 (46.1) 906 (41.5) ## race (%) ## white 2753 (77.5) 1707 (78.2) ## black 585 (16.5) 335 (15.3) ## other 213 ( 6.0) 142 ( 6.5) ## Disease.category (%) ## ARF 1581 (44.5) 909 (41.6) ## CHF 247 ( 7.0) 209 ( 9.6) ## Other 955 (26.9) 208 ( 9.5) ## MOSF 768 (21.6) 858 (39.3) ## Cancer (%) ## None 2652 (74.7) 1727 (79.1) ## Localized (Yes) 638 (18.0) 334 (15.3) ## Metastatic 261 ( 7.4) 123 ( 5.6) Only outcome variable (Length of stay); slightly different than Table 2 in Connors et al. (1996) (means 20.5 vs. 25.7; and medians 13 vs. 17). tab1 &lt;- CreateTableOne(vars = c(&quot;Y&quot;), data = ObsData, strata = &quot;A&quot;, test = FALSE) print(tab1, showAllLevels = FALSE, ) ## Stratified by A ## 0 1 ## n 3551 2184 ## Y (mean (SD)) 19.53 (23.59) 24.86 (28.90) median(ObsData$Y[ObsData$A==0]); median(ObsData$Y[ObsData$A==1]) ## [1] 12 ## [1] 16 1.6 Basic regression analysis 1.6.1 Crude analysis # adjust the exposure variable (primary interest) fit0 &lt;- lm(Y~A, data = ObsData) require(Publish) crude.fit &lt;- publish(fit0, digits=1)$regressionTable[2,] crude.fit ## Variable Units Coefficient CI.95 p-value ## 2 A 5.3 [4.0;6.7] &lt;0.1 1.6.2 Adjusted analysis # adjust the exposure variable (primary interest) + covariates out.formula &lt;- as.formula(paste(&quot;Y~ A +&quot;, paste(baselinevars, collapse = &quot;+&quot;))) fit1 &lt;- lm(out.formula, data = ObsData) adj.fit &lt;- publish(fit1, digits=1)$regressionTable[2,] 1.6.3 Regression diagnostics out.formula ## Y ~ A + Disease.category + Cancer + Cardiovascular + Congestive.HF + ## Dementia + Psychiatric + Pulmonary + Renal + Hepatic + GI.Bleed + ## Tumor + Immunosupperssion + Transfer.hx + MI + age + sex + ## edu + DASIndex + APACHE.score + Glasgow.Coma.Score + blood.pressure + ## WBC + Heart.rate + Respiratory.rate + Temperature + PaO2vs.FIO2 + ## Albumin + Hematocrit + Bilirubin + Creatinine + Sodium + ## Potassium + PaCo2 + PH + Weight + DNR.status + Medical.insurance + ## Respiratory.Diag + Cardiovascular.Diag + Neurological.Diag + ## Gastrointestinal.Diag + Renal.Diag + Metabolic.Diag + Hematologic.Diag + ## Sepsis.Diag + Trauma.Diag + Orthopedic.Diag + race + income adj.fit ## Variable Units Coefficient CI.95 p-value ## 2 A 2.9 [1.4;4.4] &lt;0.1 plot(fit1) 1.7 Comparison with literature 1.7.1 PSM Connors et al. (1996) conducted a propensity score matching analysis. Table 5 in Connors et al. (1996) showed that, after propensity score pair (1-to-1) matching, means of length of stay (\\(Y\\)), when stratified by RHC (\\(A\\)) was significantly different. We also conduct propensity score pair matching analysis. set.seed(123) require(MatchIt) ps.formula &lt;- as.formula(paste(&quot;A~&quot;, paste(baselinevars, collapse = &quot;+&quot;))) PS.fit &lt;- glm(ps.formula,family=&quot;binomial&quot;, data=ObsData) ObsData$PS &lt;- predict(PS.fit, newdata = ObsData, type=&quot;response&quot;) logitPS &lt;- -log(1/ObsData$PS - 1) match.obj &lt;- matchit(ps.formula, data =ObsData, distance = ObsData$PS, method = &quot;nearest&quot;, replace=FALSE, ratio = 1, caliper = .1*sd(logitPS)) 1.7.2 PSM diagnostics require(cobalt) bal.plot(match.obj, var.name = &quot;distance&quot;, which = &quot;both&quot;, type = &quot;histogram&quot;, mirror = TRUE) love.plot(match.obj, binary = &quot;std&quot;, thresholds = c(m = .1)) The love plot suggests satisfactory propensity score matching (all SMD &lt; 0.1). 1.7.3 PSM results matched.data &lt;- match.data(match.obj) tab1y &lt;- CreateTableOne(vars = c(&quot;Y&quot;), data = matched.data, strata = &quot;A&quot;, test = TRUE) print(tab1y, showAllLevels = FALSE, test = TRUE) ## Stratified by A ## 0 1 p test ## n 1628 1628 ## Y (mean (SD)) 21.20 (25.58) 24.05 (27.49) 0.002 We also find the same conclusion based on propensity score pair matched data. References "]]
